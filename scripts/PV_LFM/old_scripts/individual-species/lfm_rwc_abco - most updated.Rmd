---
title: "RWC x LFM"
author: "Indra Boving"
date: "10/24/2021"
output: html_document

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, results='hide', warning= FALSE)
options(knitr.duplicate.label = "allow")
library(here)
library(janitor)
library(tidyverse)
library(plotly)
library(DT)
library(broom)
library(lubridate)
library(udpipe)
library(equatiomatic)
library(MuMIn)
# rmarkdown::render('lfm_rwc_abco.Rmd', output_file = here("htmls", "lfm_rwc_abco.html"))
```

# Section 1: Pressure Volume Curves

```{r}
data <- read_csv(here("processed-data", "allcurves_clean.csv"), show_col_types = FALSE) %>% 
  mutate(sample = as.factor(sample)) %>% 
  mutate(month = as.factor(month)) %>% 
  mutate(date = date(date))
```
 
### 1.1: Variation in TLPs
 
Look at just one species and timepoint: ABCO and fall

```{r}
pv.ABCO.all <- data %>% 
  filter(spp == "ABCO")

ggplot(pv.ABCO.all) +
  geom_point(aes(x = rwd, y = -1/water_potential, color = as.factor(date)), size = .5, alpha = .5) +
  theme_light() +
  labs(x = "Relative Water Deficit", 
       y = "-1/Water potential")

pv.ABCO.fall.summary <- data %>%
  group_by(date) %>% 
  filter(spp == "ABCO" & timing == "fall" ) %>% 
  summarise(n=n(), mean=mean(tlp),sd=sd(tlp))
```

```{r}
ggplot(pv.ABCO.fall.summary) +
    geom_bar(aes(y = mean, x = date), position="dodge", stat="identity", fill = "lightblue", alpha = .5) +
    geom_errorbar(aes(x=date, ymin=mean-sd, ymax=mean+sd), width=0.4, colour="black", alpha=0.9) +
   labs(title = "ABCO TLP, fall dates") +
   theme_light()
```

In fall and spring: 

- fall both dates combined ()

```{r}
pv.ABCO.summary <- data %>%
  group_by(timing) %>% 
  filter(spp == "ABCO") %>% 
  summarise(n=n(), mean=mean(tlp),sd=sd(tlp))

 ggplot(pv.ABCO.summary) +
    geom_bar(aes(y = mean, x = timing), position="dodge", stat="identity", fill = "lightblue", alpha = .5) +
    geom_errorbar(aes(x=timing, ymin=mean-sd, ymax=mean+sd), width=0.4, colour="black", alpha=0.9) +
   labs(title = "ABCO TLP, all dates", 
        y = "TLP (-Mpa)", 
        x = "timing") +
   theme_light()
```

See if sig. difference in TLP:

```{r, include = TRUE}
#Split df into groups, then pull sample vectors
fall.ABCO <- pv.ABCO.all %>% 
  filter(timing == "fall") %>% 
  group_by(sample) %>% 
  arrange(water_potential) %>%
  filter(row_number()==1) %>% 
  pull(tlp)

spring.ABCO <- pv.ABCO.all %>% 
  filter(timing == "spring") %>% 
   group_by(sample) %>% 
  arrange(water_potential) %>%
  filter(row_number()==1) %>% 
  pull(tlp)

ABCO_tlp_t <- t.test(spring.ABCO, fall.ABCO)
ABCO_tlp_t
```


### 1.2: Try to predict Mpa from LFM with just one species

1.  Get datasets in order:

-   select for just the species and date we are interested in
-   remove any anomalous curves
-   pull the TLP as a value
-   make two sub-datasets: one for all points above the TLP, one for all points below the TLP

```{r message=FALSE, warnings=F}
pv.ABCO.fall <- data %>%
  filter(spp == "ABCO" & timing == "fall" ) %>% 
  filter(sample != 3)

ABCO.tlp <- pv.ABCO.fall %>% 
  summarise(mean(tlp)) %>% pull()

ABCO.sd <- pv.ABCO.fall %>% 
  summarise(sd(tlp)) %>% pull()
```

For fall PV curves, the mean TLP = `r round(ABCO.tlp,2)`, sd = `r round(ABCO.sd,2)`

```{r, echo=FALSE, message=FALSE, results='hide'}
pv.ABCO.fall %>% 
  ggplot(aes(y = water_potential, x = lfm, color = as.factor(date))) +
  geom_point(alpha = .5, size = .5) +
  geom_hline(yintercept = ABCO.tlp,
             colour = "lightblue") +
  labs(title = "ABCO Pressure Volume Curves, LFM x Mpa", 
       x = "LFM (%)", y = "Mpa") +
  theme_light()
```
Subset data based on TLP: 

```{r}
ABCO.above.tlp <- pv.ABCO.fall %>% 
  filter(water_potential > tlp) 
# %>% 
#   filter(lfm < 200, lfm > 90)

ABCO.below.tlp <- pv.ABCO.fall %>% 
  filter(water_potential < tlp)
```

#### 2.  For points below the TLP, there should be a linear relationship between -1/Mpa and LFM

```{r}
ABCO.below.tlp %>% 
ggplot(aes(y = -1/water_potential, x = lfm, color = as.factor(sample), shape = as.factor(month))) +
  geom_jitter(alpha = .6, size = 1) +
  geom_smooth(method = "lm", se = FALSE, size = .5, alpha = .5) +
  labs(y = "-1/Mpa", x = "LFM (%)") +
  theme_light()

fit.below.ABCO <-lm(-1/water_potential~lfm, ABCO.below.tlp)
summary(fit.below.ABCO)

mpa.predicted.r <- predict.lm(fit.below.ABCO, newdata = data_frame(lfm = 180)) %>% as.numeric() #use this to extract lfm
mpa.predicted.r
```


#### 2.1. Try adding in other predictors: 
```{r}
options(na.action = "na.fail") # Required for dredge to run 

fit.below.ABCO_all <- MuMIn::dredge(lm(-1/water_potential~lfm + po + swc + rwc_at_tlp, ABCO.below.tlp))

options(na.action = "na.omit") # set back to default

head(fit.below.ABCO_all)
```
This is the model that dredge() likes the best: 

```{r}
top_model_below <- get.models(fit.below.ABCO_all, subset = 1)[[1]]
summary(top_model_below)
```
 
VIFs:
```{r}
car::vif(top_model_below) ##
plot(top_model_below)
#VIF is ok: less than 4 for mpa and LFM.
extract_eq(top_model_below)
```
#### 3.  For points above the TLP, there should be a linear relationship between Mpa and lfm

```{r}
ggplot(data = ABCO.above.tlp, aes(y = water_potential, x = lfm, color = sample, shape = as.factor(date))) +
  geom_jitter(alpha = .6, size = 1) +
  geom_smooth(method = "lm", se = FALSE, size = .5, alpha = .5) +
labs(y = "Mpa", x = "LFM (%)")+
  theme_light()

fit.above.ABCO <- lm(water_potential ~ lfm, ABCO.above.tlp)
summary(fit.above.ABCO)

lfm.predicted.r.fit1 <- predict.lm(fit.above.ABCO, newdata = data_frame(lfm = 150, swc = 1.3)) %>% as.numeric() #use this to extract lfm
lfm.predicted.r.fit1
```


```{r}
#Adding in SWC might help model?
fit2 <- lm(water_potential ~ lfm + swc, ABCO.above.tlp)
summary(fit2)

lfm.predicted.r <- predict.lm(fit2, newdata = data_frame(lfm = 150, swc = 1.3)) %>% as.numeric() #use this to extract lfm
lfm.predicted.r
```

We have some linear models that should be able to predict Mpa from LFM. Now, to test it out...

#### 3.1. Try adding in other predictors: 
```{r}
options(na.action = "na.fail") # Required for dredge to run 

fit.above.ABCO_all <- MuMIn::dredge(lm(water_potential~ lfm + po + swc + rwc_at_tlp, ABCO.above.tlp))

options(na.action = "na.omit") # set back to default

head(fit.above.ABCO_all)
```
This is the model that dredge() likes the best: 

```{r}
top_model_above <- get.models(fit.above.ABCO_all, subset = 1)[[1]]
summary(top_model_above)
```
 
VIFs:
```{r}
car::vif(top_model_above) ##
plot(top_model_above)
#VIF is ok: less than 4 for mpa and LFM.
```

# Sections 2-3: Can we predict actual values using the models built from the PV curves?

### 2.1: Flam-curve values

- Read in flam curve data

```{r}
flam_curve_phys_all <- read_csv(here("processed-data", "flam_curve_phys_all.csv"), show_col_types = FALSE) %>% 
  mutate(swc = swc_sat)
```

- Use `predict()` to see if we can use PV curve models to get values collected during flammability curve testing. 

```{r}
#Our models: 
pretty1 <- extract_eq(fit.below.ABCO)
pretty1
pretty2 <- extract_eq(fit.above.ABCO)
pretty2
```

We're just interested in ABCO, so just look there: 

```{r}
flam_curve_phys_ABCO_above <- flam_curve_phys_all %>% 
  filter(rwc_new < 100) %>% 
  filter(spp == "ABCO") %>% 
  filter(mpa > tlp)

flam_curve_phys_ABCO_below <- flam_curve_phys_all %>% 
  filter(rwc_new < 100) %>% 
  filter(spp == "ABCO") %>% 
  filter(mpa < tlp)
```

###  2.2 Predict below TLP: 

#### 2.2.1 Simple model - below: 

```{r}
eq <- extract_eq(fit.below.ABCO)
eq
```

```{r}
predict.below <- predict(fit.below.ABCO, newdata = flam_curve_phys_ABCO_below, se.fit = TRUE, interval = "confidence") #make prediction

# Bind to the data to make it actually useful:

predict.df.below <- data.frame(flam_curve_phys_ABCO_below, predict.below)

predict.df.below %>% 
  ggplot(aes(y = -1/water_potential, x = fit.fit)) +
  geom_point() +
  geom_abline(method = lm) +
  geom_abline(color = "red") +
  ylim(0, 1) +
  xlim(0, 1) +
  labs(title = "ABCO.Actual vs. predicted water potential for points BELOW the TLP", 
       y = "Actual -1/Mpa", 
       x = "Predicted -1/Mpa") +
   theme_light() 
```


```{r}
predict.df.below %>% 
  ggplot(aes(y = water_potential, x = -1/fit.fit)) +
  geom_point() +
  geom_abline(method = lm) +
  geom_abline(color = "red") +
  ylim(0, -5) +
  xlim(0, -5) +
  labs(title = "ABCO. Actual vs. predicted water potential for points BELOW the TLP", 
       y = "Actual Mpa", 
       x = "Predicted Mpa") +
   theme_light() 
```


```{r, echo = FALSE, messages = "hide", warning = FALSE}
predict_graph_below <- ggplot(predict.df.below, aes(x = lfm, y = fit.fit)) +
  geom_point(color = "lightblue", alpha = 0.7) +
  geom_point(data = flam_curve_phys_ABCO_below, aes(x = lfm, y = -1/mpa), alpha = 0.7) +
 # facet_wrap(~St) +
  labs(x = "LFM (%)", 
       y = "Water Potential (Mpa)", 
       title = "Predicted (lightblue) vs. observed (black) LFM and Mpa for point BELOW the TLP (ABCO)") +
 # scale_x_continuous(limits = c(500,3500), breaks = seq(500, 3500, by = 1000)) +
 # scale_y_continuous(limits = c(0,1.5e6))
  theme_light() 
predict_graph_below
```

#### 2.2.2. Complex model  - below: 

Since we don't have Po for the flam. curve data, we'll have to do the best we can and only use swc

```{r}
complex_model_below <- lm(formula = -1/water_potential ~ lfm + swc + 1, data = ABCO.below.tlp)

eq <-extract_eq(complex_model_below)
eq
```


```{r}
predict.below <- predict(complex_model_below, newdata = flam_curve_phys_ABCO_below, se.fit = TRUE, interval = "confidence") #make prediction

# Bind to the data to make it actually useful:

predict.df.below <- data.frame(flam_curve_phys_ABCO_below, predict.below)

predict.df.below %>% 
  ggplot(aes(y = -1/water_potential, x = fit.fit)) +
  geom_point() +
  geom_abline(method = lm) +
  geom_abline(color = "red") +
  ylim(0, 1) +
  xlim(0, 1) +
  labs(title = "ABCO - Complex model: Actual vs. predicted, BELOW the TLP", 
       y = "Actual -1/Mpa", 
       x = "Predicted -1/Mpa") +
   theme_light() 
```


```{r}
predict.df.below %>% 
  ggplot(aes(y = water_potential, x = -1/fit.fit)) +
  geom_point() +
  geom_abline(method = lm) +
  geom_abline(color = "red") +
  ylim(0, -5) +
  xlim(0, -5) +
  labs(title = "ABCO - Complex model: Actual vs. predicted BELOW the TLP", 
       y = "Actual Mpa", 
       x = "Predicted Mpa") +
   theme_light() 
```


```{r, echo = FALSE, messages = "hide", warning = FALSE}
predict_graph_below <- ggplot(predict.df.below, aes(x = lfm, y = fit.fit)) +
  geom_point(color = "lightblue", alpha = 0.7) +
  geom_point(data = flam_curve_phys_ABCO_below, aes(x = lfm, y = -1/mpa), alpha = 0.7) +
 # facet_wrap(~St) +
  labs(x = "LFM (%)", 
       y = "Water Potential (Mpa)", 
       title = "Complex model: Predicted (lightblue) vs. observed (black) LFM and Mpa for point BELOW the TLP (ABCO)") +
 # scale_x_continuous(limits = c(500,3500), breaks = seq(500, 3500, by = 1000)) +
 # scale_y_continuous(limits = c(0,1.5e6))
  theme_light() 
predict_graph_below
```

####2.2.3. Simple model - above: 

```{r}
eq <-extract_eq(fit.above.ABCO)
eq
```


```{r}
predict.above <- predict(fit.above.ABCO, newdata = flam_curve_phys_ABCO_above, se.fit = TRUE, interval = "confidence") #make prediction

# Bind to the data to make it actually useful:

predict.df.above <- data.frame(flam_curve_phys_ABCO_above, predict.above)

predict.df.above %>% 
  ggplot(aes(y = water_potential, x = fit.fit)) +
  geom_point() +
  geom_abline(method = lm) +
  geom_abline(color = "red") +
  ylim(0, -3) +
  xlim(0, -3) +
  labs(title = "Actual vs. predicted water potential for points ABOVE the TLP", 
       y = "Actual Mpa", 
       x = "Predicted Mpa") +
   theme_light() 
```

```{r, echo = FALSE, messages = "hide", warning = FALSE}
predict_graph_above <- ggplot(predict.df.above, aes(x = lfm, y = fit.fit)) +
  geom_point(color = "lightblue", alpha = 0.7) +
  geom_point(data = flam_curve_phys_ABCO_above, aes(x = lfm, y = mpa), alpha = 0.7) +
 # facet_wrap(~St) +
  labs(x = "LFM (%)", 
       y = "Water Potential (Mpa)", 
       title = "Predicted (lightblue) vs. observed (black) LFM and Mpa for points ABOVE the TLP (ABCO)") +
 # scale_x_continuous(limits = c(500,3500), breaks = seq(500, 3500, by = 1000)) +
 # scale_y_continuous(limits = c(0,1.5e6))
  theme_light() 
predict_graph_above
```


#### 2.2.4 Complex model - above: 

```{r}
complex_model_above <- lm(formula = water_potential ~ lfm + swc + 1, data = ABCO.above.tlp)

eq <-extract_eq(complex_model_above)
eq
```

```{r}
predict.above <- predict(complex_model_above, newdata = flam_curve_phys_ABCO_above, se.fit = TRUE, interval = "confidence") #make prediction

# Bind to the data to make it actually useful:

predict.df.above <- data.frame(flam_curve_phys_ABCO_above, predict.above)

predict.df.above %>% 
  ggplot(aes(y = water_potential, x = fit.fit)) +
  geom_point() +
  geom_abline(method = lm) +
  geom_abline(color = "red") +
  ylim(0, -3) +
  xlim(0, -3) +
  labs(title = "Complex: Actual vs. predicted water potential for points ABOVE the TLP", 
       y = "Actual Mpa", 
       x = "Predicted Mpa") +
   theme_light() 
```

```{r, echo = FALSE, messages = "hide", warning = FALSE}
predict_graph_above <- ggplot(predict.df.above, aes(x = lfm, y = fit.fit)) +
  geom_point(color = "lightblue", alpha = 0.7) +
  geom_point(data = flam_curve_phys_ABCO_above, aes(x = lfm, y = mpa), alpha = 0.7) +
 # facet_wrap(~St) +
  labs(x = "LFM (%)", 
       y = "Water Potential (Mpa)", 
       title = "Complex: Predicted (lightblue) vs. observed (black) LFM and Mpa for points ABOVE the TLP (ABCO)") +
 # scale_x_continuous(limits = c(500,3500), breaks = seq(500, 3500, by = 1000)) +
 # scale_y_continuous(limits = c(0,1.5e6))
  theme_light() 
predict_graph_above
```

### 3.1: Field data

This data is from measurements of predawn and midday Mpa, and midday measured LFM. SWC is equivalent to the wettest lfm measured for each invidual divided by 100 to get *grams water/grams dry*. 

- Use `predict()` to see if we can use PV curve models to get values collected in the field (predict midday Mpa from LFM): 

```{r}
field_data_ABCO <- read_csv(here("processed-data", "field_data.csv"), show_col_types = FALSE) %>% 
  filter(spp == "ABCO")
```

We're just interested in ABCO, so just look there: 

```{r}
field_data_ABCO_above <- field_data_ABCO %>% 
  filter(water_potential > tlp)

field_data_ABCO_below <- field_data_ABCO %>% 
  filter(water_potential < tlp)
```

#### 3.2.1 Simple model - above

```{r}
eq <-extract_eq(fit.below.ABCO)
eq
```

```{r}
predict.below <- predict(fit.below.ABCO, newdata = field_data_ABCO_below, se.fit = TRUE, interval = "confidence") #make prediction

# Bind to the data to make it actually useful:

predict.df.below <- data.frame(field_data_ABCO_below, predict.below)

predict.df.below %>% 
  ggplot(aes(y = -1/water_potential, x = fit.fit)) +
  geom_point() +
  geom_abline(method = lm) +
  geom_abline(color = "red") +
  ylim(0, 1) +
  xlim(0, 1) +
  labs(title = "Actual vs. predicted water potential for points BELOW the TLP (ABCO)", 
       y = "Actual -1/Mpa", 
       x = "Predicted -1/Mpa") +
   theme_light() 

predict.df.below %>% 
  ggplot(aes(y = water_potential, x = -1/fit.fit)) +
  geom_point() +
  geom_abline(method = lm) +
  geom_abline(color = "red") +
  ylim(0, -5) +
  xlim(0, -5) +
  labs(title = "Actual vs. predicted for points BELOW TLP (ABCO)", 
       y = "Actual Mpa", 
       x = "Predicted Mpa") +
   theme_light() 
```


```{r, echo = FALSE, messages = "hide", warning = FALSE}
predict_graph_below <- ggplot(predict.df.below, aes(x = lfm, y = fit.fit)) +
  geom_point(color = "lightblue", alpha = 0.7) +
  geom_point(data = field_data_ABCO_below, aes(x = lfm, y = -1/water_potential), alpha = 0.7) +
 # facet_wrap(~St) +
  labs(x = "LFM (%)", 
       y = "Water Potential (Mpa)", 
       title = "Predicted (lightblue) vs. observed (black) LFM and Mpa BELOW TLP (ABCO)") +
 # scale_x_continuous(limits = c(500,3500), breaks = seq(500, 3500, by = 1000)) +
 # scale_y_continuous(limits = c(0,1.5e6))
  theme_light() 
predict_graph_below
```

#### 3.2.2. Complex model  - below: 

Since we don't have Po for the field data, so we'll have to do the best we can. 

```{r}
complex_model_below <- lm(formula = -1/water_potential ~ lfm + swc + 1, data = ABCO.below.tlp)

eq <-extract_eq(complex_model_below)
eq
```

```{r}
predict.below <- predict(complex_model_below, newdata = field_data_ABCO_below, se.fit = TRUE, interval = "confidence") #make prediction

# Bind to the data to make it actually useful:

predict.df.below <- data.frame(field_data_ABCO_below, predict.below)

predict.df.below %>% 
  ggplot(aes(y = -1/water_potential, x = fit.fit)) +
  geom_point() +
  geom_abline(method = lm) +
  geom_abline(color = "red") +
  ylim(0, 1) +
  xlim(0, 1) +
  labs(title = "ABCO - Complex model: Actual vs. predicted, BELOW the TLP", 
       y = "Actual -1/Mpa", 
       x = "Predicted -1/Mpa") +
   theme_light() 
```


```{r}
predict.df.below %>% 
  ggplot(aes(y = water_potential, x = -1/fit.fit)) +
  geom_point() +
  geom_abline(method = lm) +
  geom_abline(color = "red") +
  ylim(0, -5) +
  xlim(0, -5) +
  labs(title = "ABCO - Complex model: Actual vs. predicted BELOW the TLP", 
       y = "Actual Mpa", 
       x = "Predicted Mpa") +
   theme_light() 
```


```{r, echo = FALSE, messages = "hide", warning = FALSE}
predict_graph_below <- ggplot(predict.df.below, aes(x = lfm, y = fit.fit)) +
  geom_point(color = "lightblue", alpha = 0.7) +
  geom_point(data = flam_curve_phys_ABCO_below, aes(x = lfm, y = -1/mpa), alpha = 0.7) +
 # facet_wrap(~St) +
  labs(x = "LFM (%)", 
       y = "Water Potential (Mpa)", 
       title = "Complex model: Predicted (lightblue) vs. observed (black) LFM and Mpa for point BELOW the TLP (ABCO)") +
 # scale_x_continuous(limits = c(500,3500), breaks = seq(500, 3500, by = 1000)) +
 # scale_y_continuous(limits = c(0,1.5e6))
  theme_light() 
predict_graph_below
```

#### 3.2.3 Simple model - above

```{r}
eq <- extract_eq(fit.above.ABCO)
eq
```

```{r}
predict.above <- predict(fit.above.ABCO, newdata = field_data_ABCO_above, se.fit = TRUE, interval = "confidence") #make prediction

# Bind to the data to make it actually useful:

predict.df.above <- data.frame(field_data_ABCO_above, predict.above)

predict.df.above %>% 
  ggplot(aes(y = water_potential, x = fit.fit)) +
  geom_point() +
  geom_abline(method = lm) +
  geom_abline(color = "red") +
  ylim(0, -3) +
  xlim(0, -3) +
  labs(title = "Actual vs. predicted water potential for points ABOVE the TLP (ABCO)", 
       y = "Actual Mpa", 
       x = "Predicted Mpa") +
 theme_light() 
```

```{r, echo = FALSE, messages = "hide", warning = FALSE}
predict_graph_above <- ggplot(predict.df.above, aes(x = lfm, y = fit.fit)) +
  geom_point(color = "lightblue", alpha = 0.7) +
  geom_point(data = field_data_ABCO_above, aes(x = lfm, y = water_potential), alpha = 0.7) +
 # facet_wrap(~St) +
  labs(x = "LFM (%)", 
       y = "Water Potential (Mpa)", 
       title = "Predicted (lightblue) vs. observed (black) LFM and Mpa for points ABOVE the TLP (ABCO)")+
 # scale_x_continuous(limits = c(500,3500), breaks = seq(500, 3500, by = 1000)) +
 # scale_y_continuous(limits = c(0,1.5e6))
  theme_light() 
predict_graph_above
```

#### 3.2.4 Complex model - above: 

```{r}
complex_model_above <- lm(formula = water_potential ~ lfm + swc + 1, data = ABCO.above.tlp)

eq <-extract_eq(complex_model_above)
eq
```

```{r}
predict.above <- predict(complex_model_above, newdata = field_data_ABCO_above, se.fit = TRUE, interval = "confidence") #make prediction

# Bind to the data to make it actually useful:

predict.df.above <- data.frame(field_data_ABCO_above, predict.above)

predict.df.above %>% 
  ggplot(aes(y = water_potential, x = fit.fit)) +
  geom_point() +
  geom_abline(method = lm) +
  geom_abline(color = "red") +
  ylim(0, -3) +
  xlim(0, -3) +
  labs(title = "Complex: Actual vs. predicted water potential for points ABOVE the TLP", 
       y = "Actual Mpa", 
       x = "Predicted Mpa") +
   theme_light() 
```

```{r, echo = FALSE, messages = "hide", warning = FALSE}
predict_graph_above <- ggplot(predict.df.above, aes(x = lfm, y = fit.fit)) +
  geom_point(color = "lightblue", alpha = 0.7) +
  geom_point(data = flam_curve_phys_ABCO_above, aes(x = lfm, y = mpa), alpha = 0.7) +
 # facet_wrap(~St) +
  labs(x = "LFM (%)", 
       y = "Water Potential (Mpa)", 
       title = "Complex: Predicted (lightblue) vs. observed (black) LFM and Mpa for points ABOVE the TLP (ABCO)") +
 # scale_x_continuous(limits = c(500,3500), breaks = seq(500, 3500, by = 1000)) +
 # scale_y_continuous(limits = c(0,1.5e6))
  theme_light() 
predict_graph_above
```
